<h1 class="header">Backups Overview</h1>
<div class="clr-row">
  <div class="clr-col-lg-12 clr-col-lg-12">
    <clr-datagrid
      *ngIf="backups$ | async as backups"
      (clrDgRefresh)="refresh($event)"
      [clrDgLoading]="loading"
    >
      <clr-dg-column [clrDgField]="'id'">Backup ID</clr-dg-column>
      <clr-dg-column [clrDgField]="'sizeMB'">
        <ng-container *clrDgHideableColumn>
          Size (MB)
          <clr-dg-filter [clrDgFilter]="backupSizeFilter">
            <clr-input-container>
              <label>From:</label>
              <input
                clrInput
                type="number"
                [(ngModel)]="backupSizeFilter.ranges.fromSizeMB"
                (ngModelChange)="
                  backupSizeFilter.updateRanges({ fromSizeMB: $event })
                "
              />
            </clr-input-container>
            <clr-input-container>
              <label>To:</label>
              <input
                clrInput
                type="number"
                [(ngModel)]="backupSizeFilter.ranges.toSizeMB"
                (ngModelChange)="
                  backupSizeFilter.updateRanges({ toSizeMB: $event })
                "
              />
            </clr-input-container>
          </clr-dg-filter>
        </ng-container>
      </clr-dg-column>

      <clr-dg-column [clrDgField]="'creationDate'">
        <ng-container *clrDgHideableColumn>
          Creation Date
          <clr-dg-filter [clrDgFilter]="backupDateFilter">
            <clr-input-container>
              <label>From:</label>
              <input
                clrInput
                type="date"
                [(ngModel)]="backupDateFilter.ranges.fromDate"
                (ngModelChange)="
                  backupDateFilter.updateRanges({ fromDate: $event })
                "
              />
            </clr-input-container>
            <clr-input-container>
              <label>To:</label>
              <input
                clrInput
                type="date"
                [(ngModel)]="backupDateFilter.ranges.toDate"
                (ngModelChange)="
                  backupDateFilter.updateRanges({ toDate: $event })
                "
              />
            </clr-input-container>
          </clr-dg-filter>
        </ng-container>
      </clr-dg-column>

      <clr-dg-placeholder>We couldn't find any backups!</clr-dg-placeholder>
      <clr-dg-row *clrDgItems="let backup of backups.data" [clrDgItem]="backup">
        <clr-dg-cell>{{ backup.id }}</clr-dg-cell>
        <clr-dg-cell>{{ backup.sizeMB }}</clr-dg-cell>
        <clr-dg-cell>{{ backup.creationDate | date }}</clr-dg-cell>
        <clr-dg-action-overflow>
          <button class="action-item">More Details</button>
          <button class="action-item">Edit</button>
          <button class="action-item">Delete</button>
        </clr-dg-action-overflow>
      </clr-dg-row>

      <clr-dg-footer>
        <clr-dg-pagination
          #pagination
          [clrDgTotalItems]="(backups.paginationData.total) || 10"
        >
          <clr-dg-page-size [clrPageSizeOptions]="[10, 20, 50, 100]">
            Backups per page
          </clr-dg-page-size>
          {{ pagination.firstItem + 1 }} - {{ pagination.lastItem + 1 }} of
          {{ backups.paginationData.total }} backups
        </clr-dg-pagination>
      </clr-dg-footer>
    </clr-datagrid>
  </div>
</div>

<div class="clr-row">
  <!-- Timeline Chart Section -->
  <div class="clr-col-sm-12 clr-col-md-6">
    <!-- Time Range Buttons -->
    <div class="btn-group">
      <button
        *ngFor="let range of timeRanges"
        class="btn"
        [class.btn-primary]="selectedTimeRange === range"
        (click)="setTimeRange(range)"
      >
        Last {{ range | titlecase }}
      </button>
    </div>

    <!-- Timeline Chart -->
    <h4>Last Backups</h4>
    <div
      id="backupTimelineChart"
      class="mt-4"
      style="width: 100%; height: 400px"
    ></div>
  </div>

  <!-- Size Distribution Chart Section -->
  <div class="clr-col-sm-12 clr-col-md-6">
    <h4>Size</h4>
    <div id="backupSizeChart" style="width: 100%; height: 400px"></div>
  </div>
</div>
